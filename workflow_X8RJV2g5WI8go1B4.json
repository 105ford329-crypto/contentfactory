{"updatedAt":"2025-12-26T11:15:42.655Z","createdAt":"2025-12-24T15:44:19.985Z","id":"X8RJV2g5WI8go1B4","name":"Workflow 8 - Pinterest Parser","description":null,"active":false,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"parse-pinterest","options":{}},"name":"Webhook Trigger","type":"n8n-nodes-base.webhook","typeVersion":2,"position":[240,300],"webhookId":"parse-pinterest","id":"5197dbc7-8a6a-45c5-89b8-49a40c625ffa"},{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"0 */8 * * *"}]}},"name":"Schedule Every 8h","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[240,500],"id":"fd4f5c59-5e2f-4f2e-ab0c-97b644121220"},{"parameters":{"operation":"getAll","sheetId":"={{ $env.GOOGLE_SHEET_ID }}","range":"Competitors!A:E","options":{}},"name":"Get Pinterest Competitors","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[460,500],"id":"d6325b21-135c-4846-8acb-07af7d7dd40c"},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.platform }}","operation":"equals","value2":"pinterest"}]}},"name":"Filter Pinterest Only","type":"n8n-nodes-base.if","typeVersion":2,"position":[680,500],"id":"9b8410a4-76b9-4008-9587-9419f0809395"},{"parameters":{"url":"https://api.scrapercreators.com/v1/pinterest/user","authentication":"predefinedCredentialType","nodeCredentialType":"scraperCreatorsApi","sendQuery":true,"queryParameters":{"parameters":[{"name":"username","value":"={{ $json.username || $json.body?.username }}"}]},"options":{}},"name":"ScraperCreators: Pinterest Profile","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[900,400],"id":"742663ea-15f3-40a1-9008-012ed22c3b98"},{"parameters":{"url":"https://api.scrapercreators.com/v1/pinterest/pins","authentication":"predefinedCredentialType","nodeCredentialType":"scraperCreatorsApi","sendQuery":true,"queryParameters":{"parameters":[{"name":"username","value":"={{ $json.username || $json.body?.username }}"},{"name":"limit","value":"30"}]},"options":{}},"name":"ScraperCreators: Pinterest Pins","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[900,600],"id":"53d5ff25-989f-44a3-be80-d5fad35feda4"},{"parameters":{"jsCode":"const profile = $input.first().json;\nconst pins = $input.all()[1]?.json?.pins || [];\n\n// Calculate metrics\nconst followerCount = profile.follower_count || 0;\nconst pinCount = profile.pin_count || 0;\n\nconst results = pins.map(pin => {\n  const saves = pin.save_count || 0;\n  const comments = pin.comment_count || 0;\n  const repins = pin.repin_count || 0;\n  \n  // Pins-to-Followers Ratio (similar to VFR)\n  const pfr = followerCount > 0 ? saves / followerCount : 0;\n  \n  // Engagement Rate\n  const totalEngagement = saves + comments + repins;\n  const er = saves > 0 ? (totalEngagement / saves) * 100 : 0;\n  \n  // Virality Score\n  const viralityScore = (pfr * 0.7 + er * 0.3).toFixed(2);\n  \n  return {\n    platform: 'pinterest',\n    username: profile.username,\n    pin_id: pin.id,\n    pin_url: pin.url,\n    title: pin.title || '',\n    description: pin.description || '',\n    image_url: pin.image_url,\n    saves: saves,\n    comments: comments,\n    repins: repins,\n    created_at: pin.created_at,\n    pfr: pfr.toFixed(3),\n    er: er.toFixed(2),\n    virality_score: viralityScore,\n    parsed_at: new Date().toISOString()\n  };\n});\n\nreturn results;"},"name":"Calculate Pinterest Metrics","type":"n8n-nodes-base.code","typeVersion":2,"position":[1120,500],"id":"0ba142ed-316a-4201-8143-b30eef130617"},{"parameters":{"operation":"getAll","sheetId":"={{ $env.GOOGLE_SHEET_ID }}","range":"Parsed_Videos!A:C","options":{"valueRenderMode":"UNFORMATTED_VALUE"}},"name":"Get Existing Pins","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[1340,500],"id":"85ba524a-a8f8-40e9-bf64-269be41fbf03"},{"parameters":{"jsCode":"const existingPins = $input.all()[1].map(item => item.json.pin_id);\nconst newPins = $input.first().json;\n\n// Filter only new pins\nconst filtered = newPins.filter(pin => !existingPins.includes(pin.pin_id));\n\nreturn filtered.map(pin => ({json: pin}));"},"name":"Filter New Pins Only","type":"n8n-nodes-base.code","typeVersion":2,"position":[1560,500],"id":"2fc5135a-fbeb-4397-a5fa-d8d90fede826"},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.virality_score }}","operation":"larger","value2":1}]}},"name":"Filter Viral (Score > 1.0)","type":"n8n-nodes-base.if","typeVersion":2,"position":[1780,500],"id":"e8d452cf-2277-4646-9c81-0e2882e6afed"},{"parameters":{"operation":"appendOrUpdate","sheetId":"={{ $env.GOOGLE_SHEET_ID }}","range":"Parsed_Videos","options":{"cellFormat":"USER_ENTERED","useAppend":true},"columns":{"mappings":[{"fromColumn":"platform","toColumn":"platform"},{"fromColumn":"username","toColumn":"username"},{"fromColumn":"pin_id","toColumn":"content_id"},{"fromColumn":"pin_url","toColumn":"url"},{"fromColumn":"title","toColumn":"title"},{"fromColumn":"saves","toColumn":"views"},{"fromColumn":"repins","toColumn":"shares"},{"fromColumn":"pfr","toColumn":"vfr"},{"fromColumn":"er","toColumn":"er"},{"fromColumn":"virality_score","toColumn":"virality_score"},{"fromColumn":"parsed_at","toColumn":"parsed_at"}]}},"name":"Save to Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[2000,400],"id":"a7bbb086-7bc0-49c9-bbf8-7be17e5f9b24"},{"parameters":{"jsCode":"const pins = $input.all();\nconst totalNew = pins.length;\n\nif (totalNew === 0) {\n  return {message: 'ÐÐ¾Ð²Ñ‹Ñ… Pinterest Ð¿Ð¸Ð½Ð¾Ð² Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾'};\n}\n\nconst sorted = pins.sort((a, b) => \n  parseFloat(b.json.virality_score) - parseFloat(a.json.virality_score)\n);\n\nconst top3 = sorted.slice(0, 3);\n\nconst message = `ðŸ“Œ Pinterest: Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ ${totalNew} Ð½Ð¾Ð²Ñ‹Ñ… Ð²Ð¸Ñ€ÑƒÑÐ½Ñ‹Ñ… Ð¿Ð¸Ð½Ð¾Ð²\\n\\n` +\n  top3.map((pin, i) => \n    `${i + 1}. ${pin.json.title}\\n` +\n    `   ðŸ’¾ Saves: ${pin.json.saves} | ðŸ“Š Score: ${pin.json.virality_score}\\n` +\n    `   ðŸ”— ${pin.json.pin_url}`\n  ).join('\\n\\n');\n\nreturn {message, chatId: process.env.TELEGRAM_CHAT_ID};"},"name":"Format Telegram Notification","type":"n8n-nodes-base.code","typeVersion":2,"position":[2220,400],"id":"9e94c5d6-ce59-48b3-af77-8ae4b3c0b62c"},{"parameters":{"chatId":"={{ $json.chatId }}","text":"={{ $json.message }}"},"name":"Send to Telegram","type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[2440,400],"id":"41d0a091-7106-453b-b734-e8b1e1c7f5e6"},{"parameters":{"jsCode":"const cost = 0.03;\nreturn {\n    timestamp: new Date().toISOString(),\n    service: 'scraper_creators',\n    operation: 'pinterest_parse',\n    cost: cost,\n    details: JSON.stringify({parsed_count: $input.all().length})\n};"},"name":"Prepare API Costs","type":"n8n-nodes-base.code","typeVersion":2,"position":[800,300],"id":"0daa082e-bf3b-487a-a0d1-6e2228a76e1a"},{"parameters":{"operation":"appendOrUpdate","sheetId":"={{ $env.GOOGLE_SHEET_ID }}","range":"API_Costs","options":{"cellFormat":"USER_ENTERED","useAppend":true},"columns":{"mappings":[{"fromColumn":"timestamp","toColumn":"timestamp"},{"fromColumn":"service","toColumn":"service"},{"fromColumn":"operation","toColumn":"operation"},{"fromColumn":"cost","toColumn":"cost"},{"fromColumn":"details","toColumn":"details"}]}},"name":"Save API Costs","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[1000,300],"id":"a6397b64-03ae-4f94-aa00-54cdebfa23ce"}],"connections":{"Webhook Trigger":{"main":[[{"node":"ScraperCreators: Pinterest Profile","type":"main","index":0}]]},"Schedule Every 8h":{"main":[[{"node":"Get Pinterest Competitors","type":"main","index":0}]]},"Get Pinterest Competitors":{"main":[[{"node":"Filter Pinterest Only","type":"main","index":0}]]},"Filter Pinterest Only":{"main":[[{"node":"ScraperCreators: Pinterest Profile","type":"main","index":0}]]},"ScraperCreators: Pinterest Profile":{"main":[[{"node":"ScraperCreators: Pinterest Pins","type":"main","index":0},{"node":"Calculate Pinterest Metrics","type":"main","index":0},{"node":"Prepare API Costs","type":"main","index":0}]]},"ScraperCreators: Pinterest Pins":{"main":[[{"node":"Calculate Pinterest Metrics","type":"main","index":0}]]},"Calculate Pinterest Metrics":{"main":[[{"node":"Get Existing Pins","type":"main","index":0},{"node":"Filter New Pins Only","type":"main","index":0}]]},"Get Existing Pins":{"main":[[{"node":"Filter New Pins Only","type":"main","index":0}]]},"Filter New Pins Only":{"main":[[{"node":"Filter Viral (Score > 1.0)","type":"main","index":0}]]},"Filter Viral (Score > 1.0)":{"main":[[{"node":"Save to Google Sheets","type":"main","index":0},{"node":"Format Telegram Notification","type":"main","index":0}]]},"Save to Google Sheets":{"main":[[{"node":"Format Telegram Notification","type":"main","index":0}]]},"Format Telegram Notification":{"main":[[{"node":"Send to Telegram","type":"main","index":0}]]},"Prepare API Costs":{"main":[[{"node":"Save API Costs","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","availableInMCP":false},"staticData":null,"meta":null,"pinData":null,"versionId":"66874fa0-e8aa-49e5-a9ce-80eff0c86ddc","versionCounter":4,"triggerCount":0,"shared":[{"updatedAt":"2025-12-24T15:44:19.985Z","createdAt":"2025-12-24T15:44:19.985Z","role":"workflow:owner","workflowId":"X8RJV2g5WI8go1B4","projectId":"RBPPu9AATeVK4CWS","project":{"updatedAt":"2025-09-12T08:23:30.032Z","createdAt":"2025-04-06T11:26:22.366Z","id":"RBPPu9AATeVK4CWS","name":"Ruslan 111 <105ford329@gmail.com>","type":"personal","icon":null,"description":null,"projectRelations":[{"updatedAt":"2025-04-06T11:26:22.366Z","createdAt":"2025-04-06T11:26:22.366Z","userId":"857820b0-f530-430a-b69c-96a0ec14e554","projectId":"RBPPu9AATeVK4CWS","user":{"updatedAt":"2026-01-15T07:57:19.897Z","createdAt":"2025-04-06T11:26:21.157Z","id":"857820b0-f530-430a-b69c-96a0ec14e554","email":"105ford329@gmail.com","firstName":"Ruslan","lastName":"111","personalizationAnswers":null,"settings":{"userActivated":true,"easyAIWorkflowOnboarded":true,"firstSuccessfulWorkflowId":"28ntO5KaE2bWGofZ","userActivatedAt":1746260344700,"npsSurvey":{"responded":true,"lastShownAt":1762343016289},"dismissedCallouts":{"preBuiltAgentsCalloutTelegram":true}},"disabled":false,"mfaEnabled":false,"lastActiveAt":"2026-01-14","isPending":false}}]}}],"tags":[]}